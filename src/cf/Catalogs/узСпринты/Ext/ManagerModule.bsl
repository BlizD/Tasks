Функция ПолучитьТекущийСпринт() Экспорт 
	
	
	Только1АктивныйСпринт = Ложь;
	пСпринт = Неопределено;
	ТекстОшибки = Неопределено;
	
	РезультатФункции = Новый Структура();
	РезультатФункции.Вставить("Только1АктивныйСпринт",Только1АктивныйСпринт);
	РезультатФункции.Вставить("Спринт",пСпринт);
	РезультатФункции.Вставить("ТекстОшибки",ТекстОшибки);
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	узСпринты.Ссылка,
	|	узСпринты.ДатаНачала,
	|	узСпринты.ДатаОкончания,
	|	узСпринты.СпринтЗавершен
	|ИЗ
	|	Справочник.узСпринты КАК узСпринты
	|ГДЕ
	|	НЕ узСпринты.СпринтЗавершен";
	
	РезультатЗапроса = Запрос.Выполнить();
	Если РезультатЗапроса.Пустой() Тогда
		ТекстОшибки = "Ошибка! не удалось найти активные спринты";
	Иначе
		Выборка = РезультатЗапроса.Выбрать();
		Если Выборка.Количество() > 1 Тогда
			Только1АктивныйСпринт = Ложь;
		Иначе
			Только1АктивныйСпринт = Истина;
			Выборка.Следующий();
			пСпринт = Выборка.Ссылка;
		Конецесли;
	Конецесли;	
	
	РезультатФункции.Вставить("Только1АктивныйСпринт",Только1АктивныйСпринт);
	РезультатФункции.Вставить("Спринт",пСпринт);
	РезультатФункции.Вставить("ТекстОшибки",ТекстОшибки);	
	Возврат РезультатФункции;

КонецФункции 