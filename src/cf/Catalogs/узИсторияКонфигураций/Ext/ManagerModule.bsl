Функция ПолучитьПоследнююЗагруженнуюВерсию(Конфигурация) Экспорт
	Перем пВерсия;
	
	пВерсия = 0;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	узИсторияКонфигураций.Версия КАК Версия
	|ИЗ
	|	Справочник.узИсторияКонфигураций КАК узИсторияКонфигураций
	|ГДЕ
	|	узИсторияКонфигураций.Владелец = &Конфигурация
	|
	|УПОРЯДОЧИТЬ ПО
	|	Версия УБЫВ";
	
	Запрос.УстановитьПараметр("Конфигурация",Конфигурация);
	РезультатЗапроса = Запрос.Выполнить();
	
	Если НЕ РезультатЗапроса.Пустой() Тогда
		Выборка = РезультатЗапроса.Выбрать();
		Выборка.Следующий();
		пВерсия = Выборка.Версия;
	Конецесли;	
	
	Возврат пВерсия;
КонецФункции 

Функция ПолучитьНовуюВерсиюДляВводаВручную(Конфигурация) Экспорт 
	пНоваяВерсия = 1;
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	МАКСИМУМ(узИсторияКонфигураций.Версия) КАК Версия
	|ИЗ
	|	Справочник.узИсторияКонфигураций КАК узИсторияКонфигураций
	|ГДЕ
	|	узИсторияКонфигураций.Владелец = &Владелец";
	
	Запрос.УстановитьПараметр("Владелец", Конфигурация);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();	
	Пока Выборка.Следующий() Цикл
		Если НЕ ЗначениеЗаполнено(Выборка.Версия) Тогда
			Продолжить;
		Конецесли;
		пНоваяВерсия = Выборка.Версия + 1; 
	КонецЦикла;
	Возврат пНоваяВерсия;

КонецФункции 

Функция ПолучитьНаименование(Версия, ДатаВерсии) Экспорт
	пНаименование = "Изменение конфигурации № " + Версия + " от " + ДатаВерсии;
	Возврат пНаименование;
КонецФункции 